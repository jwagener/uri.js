var __hasProp=Object.prototype.hasOwnProperty;
window.URI=function(g,h){var i,j;g==null&&(g="");h==null&&(h={});j=/^(?:([^:\/?\#]+):)?(?:\/\/([^\/?\#]*))?([^?\#]*)(?:\?([^\#]*))?(?:\#(.*))?/;i=/^(?:([^@]*)@)?([^:]*)(?::(\d*))?/;this.scheme=this.user=this.password=this.host=this.port=this.path=this.query=this.fragment=null;this.toString=function(){var a;a="";this.isAbsolute()&&(a+=this.scheme,a+="://",this.user!=null&&(a+=this.user+":"+this.password+"@"),a+=this.host,this.port!=null&&(a+=":"+this.port));a+=this.path;if(this.path===""&&(this.query!=
null||this.fragment!=null))a+="/";this.query!=null&&(a+=this.encodeParamsWithPrepend(this.query,"?"));this.fragment!=null&&(a+=this.encodeParamsWithPrepend(this.fragment,"#"));return a};this.isRelative=function(){return!this.isAbsolute()};this.isAbsolute=function(){return this.host!=null};this.decodeParams=function(a){var c,d,b,e,f;a==null&&(a="");d={};f=a.split("&");a=0;for(e=f.length;a<e;a++)c=f[a],c!==""&&(b=c.split("="),c=decodeURIComponent(b[0]),b=decodeURIComponent(b[1]||"").replace(/\+/g," "),
this.normalizeParams(d,c,b));return d};this.normalizeParams=function(a,c,d){var b,e;d==null&&(d=NULL);b=c.match(/^[\[\]]*([^\[\]]+)\]*(.*)/);c=b[1]||"";b=b[2]||"";b===""?a[c]=d:b==="[]"?(a[c]||(a[c]=[]),a[c].push(d)):(e=b.match(/^\[\]\[([^\[\]]+)\]$/)||(e=b.match(/^\[\](.+)$/)))?(b=e[1],a[c]||(a[c]=[]),e=a[c][a[c].length-1],e!=null&&e.constructor===Object&&e[b]==null?this.normalizeParams(e,b,d):a[c].push(this.normalizeParams({},b,d))):(a[c]||(a[c]={}),a[c]=this.normalizeParams(a[c],b,d));return a};
this.encodeParamsWithPrepend=function(a,c){var d;d=this.encodeParams(a);return d!==""?c+d:""};this.encodeParams=function(a){var c,d,b,e,f;if(a.constructor===String)return a;else{a=this.flattenParams(a);d=[];e=0;for(f=a.length;e<f;e++)b=a[e],c=b[0],b=b[1],b===null?d.push(c):d.push(c+"="+encodeURIComponent(b));return d.join("&")}};this.flattenParams=function(a,c,d){var b,e,f;c==null&&(c="");d==null&&(d=[]);if(a==null)c!=null&&d.push([c,null]);else if(a.constructor===Object)for(b in a)__hasProp.call(a,
b)&&(f=a[b],e=c!==""?c+"["+b+"]":b,this.flattenParams(f,e,d));else if(a.constructor===Array){b=0;for(e=a.length;b<e;b++)f=a[b],this.flattenParams(f,c+"[]",d)}else c!==""&&d.push([c,a]);return d};this.parse=function(a,c){var d,b,e,f;a==null&&(a="");c==null&&(c={});b=function(a){return a===""?null:a};e=a.match(j);this.scheme=b(e[1]);d=e[2];if(d!=null){d=d.match(i);f=b(d[1]);if(f!=null)this.user=f.split(":")[0],this.password=f.split(":")[1];this.host=b(d[2]);this.port=parseInt(d[3],10)||null}this.path=
e[3];this.query=b(e[4]);if(c.decodeQuery)this.query=this.decodeParams(this.query);this.fragment=b(e[5]);if(c.decodeFragment)return this.fragment=this.decodeParams(this.fragment)};this.parse(g.toString(),h);return this};
