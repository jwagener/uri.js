var URI,__hasProp=Object.prototype.hasOwnProperty;
URI=function(k,j){var h,g,i;k==null&&(k="");j==null&&(j={});h=/^(?:([^@]*)@)?([^:]*)(?::(\d*))?/;this.toString=function(){var a;a="";this.isAbsolute()&&(a+=this.scheme,a+="://",this.user!=null&&(a+=this.user+":"+this.password+"@"),a+=this.host,this.port!=null&&(a+=":"+this.port));a+=this.path;this.query!=null&&(a+="?"+this.query);this.fragment!=null&&(a+="#"+this.fragment);return a};this.isRelative=function(){return!this.isAbsolute()};this.isAbsolute=function(){return this.host!=null};this.decodeParams=
function(a){var b,d,c,e,f;a==null&&(a="");d={};f=a.split("&");a=0;for(e=f.length;a<e;a++)b=f[a],c=b.split("="),b=decodeURIComponent(c[0]),c=decodeURIComponent(c[1]||""),this.normalizeParams(d,b,c);return d};this.normalizeParams=function(a,b,d){var c,e;d==null&&(d=NULL);c=b.match(/^[\[\]]*([^\[\]]+)\]*(.*)/);b=c[1]||"";c=c[2]||"";c===""?a[b]=d:c==="[]"?(a[b]||(a[b]=[]),a[b].push(d)):(e=c.match(/^\[\]\[([^\[\]]+)\]$/)||(e=c.match(/^\[\](.+)$/)))?(c=e[1],a[b]||(a[b]=[]),e=a[b][a[b].length-1],e!=null&&
e.constructor===Object&&e[c]==null?this.normalizeParams(e,c,d):a[b].push(this.normalizeParams({},c,d))):(a[b]||(a[b]={}),a[b]=this.normalizeParams(a[b],c,d));return a};this.encodeParams=function(a,b){var d,c,e,f;b==null&&(b="");c="";if(a===null)b!=null&&(c+=b);else if(a.constructor===Object)for(d in a)__hasProp.call(a,d)&&(f=a[d],e=b!==""?b+"["+d+"]":d,c+=this.encodeParams(f,e));else if(a.constructor===Array){d=0;for(e=a.length;d<e;d++)f=a[d],c+=this.encodeParams(f,b+"[]")}else c=b!==""?b+"="+encodeURIComponent(a)+
"&":a;return c};this.scheme=this.user=this.password=this.host=this.port=this.path=this.query=this.fragment=null;i=k.match(/^(?:([^:\/?\#]+):)?(?:\/\/([^\/?\#]*))?([^?\#]*)(?:\?([^\#]*))?(?:\#(.*))?/);this.scheme=i[1];g=i[2];if(g!=null){h=g.match(h);g=h[1];if(g!=null)this.user=g.split(":")[0],this.password=g.split(":")[1];this.host=h[2];this.port=parseInt(h[3],10)||null}this.path=i[3];this.query=i[4];if(j.decodeQuery)this.query=this.decodeParams(this.query);this.fragment=i[5];if(j.decodeFragment)this.fragment=
this.decodeParams(this.fragment);return this};
